# Linker flags for building libtwoyi.so as a PIE binary that works both as:
# 1. A JNI library when loaded by Android app
# 2. An executable when run directly (./libtwoyi.so -r rootfs)

[target.aarch64-linux-android]
# -rdynamic: Export all symbols to the dynamic symbol table
# --export-dynamic: Allow dlopen() to see all symbols
# --allow-shlib-undefined: Allow unresolved symbols from shared libs (resolved at runtime in Android)
rustflags = [
    "-C", "link-args=-rdynamic",
    "-C", "link-args=-Wl,--export-dynamic",
    "-C", "link-args=-Wl,--allow-shlib-undefined"
]
