#!/bin/bash
# This file was generated by AI (GitHub Copilot) and is NOT APPLICABLE for copyright.
# This is part of the threetwi project, a fork of twoyi (https://github.com/twoyi/twoyi).

# Build the libtwoyi server binary for Android arm64
# The binary is named libtwoyi so it outputs as libtwoyi.so in jniLibs
# Android automatically extracts .so files from jniLibs to nativeLibraryDir
if ! cargo build --release --target aarch64-linux-android $1; then
    echo "Build failed!"
    exit 1
fi
# Copy to jniLibs directory as libtwoyi.so
# This naming convention allows Android to automatically extract it to nativeLibraryDir
mkdir -p ../app/src/main/jniLibs/arm64-v8a
cp target/aarch64-linux-android/release/libtwoyi ../app/src/main/jniLibs/arm64-v8a/libtwoyi.so || { echo "Copy failed!"; exit 1; }
echo "Successfully built and copied libtwoyi.so to jniLibs/arm64-v8a/"
