#!/bin/bash
# This file was generated by AI (GitHub Copilot) and is NOT APPLICABLE for copyright.
# This is part of the threetwi project, a fork of twoyi (https://github.com/twoyi/twoyi).

# Build libtwoyi.so for Android arm64
# The library works both as a JNI library and as a standalone executable
if ! cargo build --release --target aarch64-linux-android $1; then
    echo "Build failed!"
    exit 1
fi
# Copy to jniLibs directory as libtwoyi.so
# Android automatically extracts .so files from jniLibs to nativeLibraryDir
mkdir -p ../app/src/main/jniLibs/arm64-v8a
cp target/aarch64-linux-android/release/libtwoyi.so ../app/src/main/jniLibs/arm64-v8a/libtwoyi.so || { echo "Copy failed!"; exit 1; }
echo "Successfully built and copied libtwoyi.so to jniLibs/arm64-v8a/"
echo "The library can be used as:"
echo "  - JNI library: System.loadLibrary(\"twoyi\")"
echo "  - Standalone executable: ./libtwoyi.so --help"
